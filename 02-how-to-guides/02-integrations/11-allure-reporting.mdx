---
title: 'Set Up Allure Reporting'
description: 'Configure comprehensive Allure reporting for your AskUI tests with environment details, step tracking, and rich visualizations'
---

Allure is a powerful test reporting framework that provides detailed insights into your AskUI test executions. This guide covers complete setup and configuration for production-ready Allure reporting.

## Prerequisites

- AskUI project with Jest configured
- Node.js (v18 or higher)
- Java Runtime Environment (JRE) for Allure command-line tool

## Installation

### Install Allure Dependencies

Add the required packages to your project:

```bash
npm install --save-dev @askui/jest-allure-circus allure-commandline
```

### Install Allure Command-Line Tool

**Option 1: Using npm (Recommended)**
```bash
npm install -g allure-commandline
```

**Option 2: Manual Installation**
1. Download Allure from the [official website](https://docs.qameta.io/allure/#_get_started)
2. Extract to your project directory or system PATH
3. Ensure Java is installed and accessible

### Verify Installation

```bash
allure --version
```

## Jest Configuration

### Update Jest Config

Modify your `jest.config.ts` to use the Allure test environment:

```typescript
// jest.config.ts
export default {
  preset: 'ts-jest',
  testEnvironment: '@askui/jest-allure-circus',
  setupFilesAfterEnv: ['<rootDir>/src/setup/allure-setup.ts'],
  testMatch: [
    "**/*.test.ts",
    "**/__tests__/**/*.[jt]s?(x)",
    "**/?(*.)+(spec|test).[tj]s?(x)"
  ],
  collectCoverageFrom: [
    'src/**/*.{ts,js}',
    '!src/**/*.d.ts',
    '!src/setup/**'
  ],
  moduleFileExtensions: ['ts', 'js'],
  transform: {
    '^.+\\.tsx?$': 'ts-jest'
  },
  testTimeout: 60000,
  reporters: [
    'default',
    ['@askui/jest-allure-circus', {
      outputDir: 'allure-results',
      subSuiteNameTemplate: 'Page: {displayName}',
      testNameTemplate: '{testName}',
      categoryDefinitions: [
        {
          name: 'Element Not Found',
          matchedStatuses: ['failed'],
          messageRegex: /.*element.*not.*found.*/
        },
        {
          name: 'Timeout',
          matchedStatuses: ['failed'],
          messageRegex: /.*timeout.*/
        }
      ]
    }]
  ]
};
```

## Custom Logger Setup

### Create Allure Logger

Create a custom logger that integrates with Allure reporting:

```typescript
// src/logging/allure-logger.ts
import "@askui/jest-allure-circus";
import * as os from 'os';

// Environment information setup
beforeAll(async () => {
    const hostname = os.hostname();
    const workspaceId = process.env.ASKUI_WORKSPACE_ID || 'default-workspace-id';

    allure.writeEnvironmentInfo({
        APP_URL: `https://app.askui.com/workspaces/${workspaceId}/quick-start`,
        DEVICE_ID: hostname,
        WORKSPACE_ID: workspaceId,
        TEST_RUNNER: 'Jest',
        PLATFORM: os.platform(),
        OS_VERSION: os.release(),
        NODE_VERSION: process.version,
        TIMESTAMP: new Date().toISOString(),
        BROWSER: process.env.BROWSER || 'Chrome',
        RESOLUTION: process.env.SCREEN_RESOLUTION || '1920x1080'
    });
});

export const logger = {
    error: (message: string, error?: any) => {
        allure.step('âŒ ERROR: ' + message, () => {
            console.error(message, error);
            if (error) {
                allure.attachment('Error Details', JSON.stringify(error, null, 2), 'application/json');
            }
            allure.attachment('Stack Trace', new Error().stack || '', 'text/plain');
        });
    },

    info: (message: string, data?: any) => {
        allure.step('ðŸ“Œ INFO: ' + message, () => {
            console.log(message, data);
            if (data) {
                allure.attachment('Additional Data', JSON.stringify(data, null, 2), 'application/json');
            }
        });
    },

    success: (message: string) => {
        allure.step('âœ… SUCCESS: ' + message, () => {
            console.log(message);
        });
    },

    warning: (message: string) => {
        allure.step('âš ï¸ WARNING: ' + message, () => {
            console.warn(message);
        });
    },

    step: (stepName: string, action: () => Promise<void> | void) => {
        return allure.step(stepName, action);
    },

    attachment: (name: string, content: string, type: string = 'text/plain') => {
        allure.attachment(name, content, type);
    },

    screenshot: async (name: string = 'Screenshot') => {
        // Add screenshot capability if needed
        // This would integrate with your screenshot capture mechanism
        allure.step(`ðŸ“¸ ${name}`, () => {
            // Screenshot logic here
        });
    }
};
```

## Enhanced Test Implementation

### Using the Logger in Tests

```typescript
// tests/purchase-flow.test.ts
import { logger } from '../src/logging/allure-logger';
import { LoginPage } from '../src/pages/login-page';
import { testData } from '../src/data/test-data';

describe('Purchase Flow Tests', () => {
    let loginPage: LoginPage;

    beforeEach(async () => {
        logger.info('Starting test setup', { testName: expect.getState().currentTestName });
        loginPage = new LoginPage();
    });

    afterEach(async () => {
        logger.info('Test cleanup completed');
    });

    it('should complete purchase for standard user', async () => {
        await logger.step('Navigate to login page', async () => {
            await loginPage.navigate();
            logger.success('Successfully navigated to login page');
        });

        await logger.step('Perform user login', async () => {
            await loginPage.login(testData.users.standard.username, testData.users.standard.password);
            logger.success('User login completed successfully');
        });

        await logger.step('Add item to cart', async () => {
            await inventoryPage.addItemToCart(testData.products.backpack.name);
            logger.success('Item added to cart');
        });

        await logger.step('Complete checkout process', async () => {
            await checkoutPage.completeCheckout(testData.checkout.validInfo);
            logger.success('Checkout process completed');
        });

        await logger.step('Verify purchase confirmation', async () => {
            const isComplete = await confirmationPage.isPurchaseComplete();
            expect(isComplete).toBe(true);
            logger.success('Purchase confirmation verified');
        });
    });

    it('should handle locked user scenario', async () => {
        await logger.step('Attempt login with locked user', async () => {
            await loginPage.login(testData.users.locked.username, testData.users.locked.password);
        });

        await logger.step('Verify error message', async () => {
            const errorMessage = await loginPage.getErrorMessage();
            expect(errorMessage).toContain('Sorry, this user has been locked out');
            logger.success('Error message verified for locked user');
        });
    });
});
```

## Advanced Configuration

### Categories and Severity

Add test categories and severity levels:

```typescript
// In your test files
describe('Critical User Flows', () => {
    it('should handle user registration', async () => {
        allure.severity('critical');
        allure.feature('User Management');
        allure.story('User Registration');
        allure.tag('smoke');
        allure.tag('critical-path');
        
        // Test implementation
    });
});
```

### Custom Attachments

Attach relevant data to test reports:

```typescript
// Attach test data
allure.attachment('Test Data Used', JSON.stringify(testData.users.standard), 'application/json');

// Attach configuration
allure.attachment('Environment Config', JSON.stringify(process.env), 'application/json');

// Attach custom logs
allure.attachment('Custom Log', 'Detailed step-by-step execution log', 'text/plain');
```

## Package.json Scripts

Add convenient scripts for report generation:

```json
{
  "scripts": {
    "test": "jest --config jest.config.ts",
    "test:allure": "jest --config jest.config.ts && npm run allure:generate",
    "allure:generate": "allure generate allure-results --clean -o allure-report",
    "allure:serve": "allure serve allure-results",
    "allure:open": "allure open allure-report",
    "clean": "rimraf allure-results allure-report",
    "clean:reports": "rimraf allure-results allure-report"
  }
}
```

## Environment Information

The logger automatically captures comprehensive environment information:

| Variable | Description | Example |
|----------|-------------|---------|
| `APP_URL` | AskUI workspace URL | `https://app.askui.com/workspaces/ws-123/quick-start` |
| `DEVICE_ID` | Machine hostname | `dev-machine-01` |
| `WORKSPACE_ID` | AskUI workspace identifier | `ws-123456` |
| `TEST_RUNNER` | Test framework | `Jest` |
| `PLATFORM` | Operating system | `darwin`, `win32`, `linux` |
| `OS_VERSION` | OS version | `10.15.7` |
| `NODE_VERSION` | Node.js version | `v18.17.0` |
| `TIMESTAMP` | Test execution time | `2024-01-15T10:30:00.000Z` |

### Adding Custom Environment Variables

Extend the environment information with project-specific data:

```typescript
// In your allure-setup.ts
allure.writeEnvironmentInfo({
    // ... existing environment info
    PROJECT_VERSION: process.env.npm_package_version || '1.0.0',
    BUILD_NUMBER: process.env.BUILD_NUMBER || 'local',
    BRANCH: process.env.GIT_BRANCH || 'main',
    COMMIT_SHA: process.env.GIT_COMMIT || 'unknown',
    TEST_ENVIRONMENT: process.env.TEST_ENV || 'development',
    BROWSER_VERSION: process.env.BROWSER_VERSION || 'latest'
});
```

## Report Generation Workflow

### Local Development

```bash
# Run tests and generate report
npm run test:allure

# Serve report locally
npm run allure:serve

# Open existing report
npm run allure:open
```

### CI/CD Integration

```yaml
# .github/workflows/test.yml
name: Test with Allure Reports

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run tests
        run: npm run test
        
      - name: Generate Allure report
        run: npm run allure:generate
        
      - name: Upload Allure results
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: allure-results
          path: allure-results/
          
      - name: Upload Allure report
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: allure-report
          path: allure-report/
```

## Troubleshooting

### Common Issues

**Java Not Found**
```bash
# Check Java installation
java -version

# Install Java if missing (Ubuntu/Debian)
sudo apt-get install default-jre

# Install Java if missing (macOS)
brew install openjdk
```

**Report Not Generating**
1. Check that `allure-results` directory exists
2. Verify Jest configuration includes Allure reporter
3. Ensure tests are creating allure step data

**Empty Reports**
- Make sure tests are using `allure.step()` or the custom logger
- Verify that test execution is completing successfully
- Check that environment variables are set correctly

### Debug Mode

Enable debug logging for troubleshooting:

```typescript
// Add to your test setup
if (process.env.DEBUG_ALLURE) {
    allure.attachment('Debug Info', JSON.stringify({
        workingDirectory: process.cwd(),
        environment: process.env,
        testConfig: 'jest.config.ts'
    }), 'application/json');
}
```

<Card title="Complete Allure Setup Example" icon="github" href="https://github.com/askui/AskUI-Best-Practices">
  See a fully configured Allure reporting setup in our example repository, including custom logger implementation and report generation scripts.
</Card>

## Next Steps

- Learn about [managing credentials securely](/02-how-to-guides/05-build-ai-agents/07-managing-credentials)
- Set up [running and debugging tests](/02-how-to-guides/05-build-ai-agents/08-running-and-debugging-tests)
- Explore [test organization best practices](/03-explanation/02-best-practices/08-test-organization)